# Web Application Security Assessment

## Executive Summary
This assessment identified multiple critical vulnerabilities affecting the target web application, including SQL injection, insecure direct object references (IDOR), and insecure file upload mechanisms leading to remote code execution. These issues expose sensitive data, allow unauthorized access, and pose a significant risk to the integrity and confidentiality of the application. The overall risk rating is High, due to the presence of exploitable flaws with potential for full system compromise.

## Scope
- Target application: Public-facing web application with user authentication, account management, and file upload features.
- In-scope components:
    - Authentication flow
    - Account management endpoints
    - File upload functionality
    - SQL query handling
- Out-of-scope items:
    - Third-party integrations
    - Mobile application
    - Internal admin interfaces not exposed externally

## Methodology
- Based on the OWASP Web Security Testing Guide
- Manual testing using Burp Suite and browser-based inspection
- No automated exploitation beyond controlled validation
- Focused on identifiying vulnerabilities with real-world impact

## Findings Summary
| ID | Vulnerability | Severity |
|----|---------------|----------|
| 1  | SQL Injection | High     |
| 2  | IDOR          | Medium   |
| 3  | File Upload   | High     |
| 4  | Authentication Bypass | High |

## Detailed Findings
### 1. SQL Injection
- Description: The application embeds user input directly into SQL queries without sanitization, allowing attackers to manipulate query logic.
- Impact: Unauthorized access to hidden product data and potential exposure of sensitive information.
- Proof of Concept: Injected ' OR 1=1-- into the category filter parameter to bypass visibility restrictions.
- Remediation:
    - Use parameterized queries.
    - Validate and sanitize user input.
    - Apply least-privilege access controls on the database.

### 2. Insecure Direct Object Reference (IDOR)

- Description: The application exposes user-specific data based on a client-supplied id parameter without verifying ownership.
- Impact: Horizontal privilege escalation and unauthorized access to other users’ data.
- Proof of Concept: Modified GET /my-account?id=wiener to GET /my-account?id=carlos and retrieved sensitive data.
- Remediation:
    - Enforce server-side authorization checks.
    - Avoid exposing direct object identifiers.
    - Use indirect references or internal mappings.

### 3. File Upload – Content-Type Restriction Bypass Leading to RCE

- Description: The server trusts the Content-Type header for file validation, allowing attackers to upload disguised executable content.
- Impact: Remote code execution, full compromise of the application, and access to sensitive system data.
- Proof of Concept: Uploaded a malicious file with a spoofed image MIME type and accessed it via predictable public URL.
- Remediation:
    - Inspect actual file content server-side.
    - Store uploads outside web-accessible directories.
    - Disable script execution in upload paths.
    - Apply strict allowlist and path sanitization.

### 4. Authentication Bypass – State Machine Flaw

- Description: The login flow relies on client-side navigation order, allowing attackers to skip intermediate steps and assume unauthorized roles.
- Impact: Full authentication bypass and access to administrative functionality.
- Proof of Concept: Dropped GET /role-selector and submitted POST /role-selector directly, gaining admin access.
- Remediation:
    - Validate authentication state server-side at every step.
    - Track session state robustly.
    - Reject inconsistent transitions and unauthorized role selections.


## Overall Risk Assessment
- Likelihood: High – vulnerabilities are easily discoverable and exploitable with basic tools.
- Impact: High – includes data exposure, privilege escalation, and remote code execution.
- Business risk: Severe – potential for data breaches, regulatory violations (e.g., GDPR), reputational damage, and operational disruption.

## Recommendations
- Short-term
    - Patch all identified vulnerabilities immediately.
    - Implement input validation and access control mechanisms.
    - Disable execution permissions in upload directories.


- Long-term
    - Conduct regular security assessments aligned with OWASP standards.
    - Implement secure development lifecycle (SDLC) practices.
    - Train development teams on secure coding and threat modeling.
    - Introduce centralized logging and anomaly detection for early warning.